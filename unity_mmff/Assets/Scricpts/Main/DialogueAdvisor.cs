using UnityEngine;
using TMPro;
using System.Collections;
using System.Linq;

public class DialogueAdvisor : MonoBehaviour
{
    [Header("References")]
    public DashboardController dashboardController;
    public TextMeshProUGUI dialogueadvisor;

    [Header("Animation Settings")]
    [Tooltip("‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)")]
    public float typingSpeed = 0.03f;
    private bool isTyping = false;

    [Header("Game Recommendations")]
    [Tooltip("‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô")]
    public string[] recommendedGames = new string[]
    {
        "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã",
        "‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã",
        "‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏°‡∏∑‡∏≠‡∏õ‡∏£‡∏≤‡∏ö‡∏¢‡∏∏‡∏á‡∏•‡∏≤‡∏¢",
        "‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤",
        "‡∏™‡∏ô‡∏∏‡∏Å‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏≤"
    };

    private int[] point;
    private string[] partNames = new string[]
    {
        "‡∏î‡πâ‡∏≤‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡πà‡∏≠‡∏ô‡∏ö‡∏ô",
        "‡∏î‡πâ‡∏≤‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏•‡πà‡∏≤‡∏á",
        "‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏Ñ‡∏•‡πà‡∏ß",
        "‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô",
        "‡∏î‡πâ‡∏≤‡∏ô‡∏°‡∏∑‡∏≠‡∏Å‡∏±‡∏ö‡∏™‡∏≤‡∏¢‡∏ï‡∏≤"
    };

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡∏¥‡∏î (‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ)
    private string[] openingMessages = new string[]
    {
        "‡∏°‡∏≤‡∏î‡∏π‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡∏î‡∏µ‡∏ô‡∏∞!",
        "‡πÄ‡∏≠‡∏≤‡∏•‡πà‡∏∞! ‡∏°‡∏≤‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÑ‡∏´‡∏ô‡∏ï‡πà‡∏≠‡∏î‡∏µ",
        "‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡πÄ‡∏Å‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏•‡∏¢!",
        "‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏°‡∏±‡πâ‡∏¢? ‡∏°‡∏≤‡∏î‡∏π‡∏Å‡∏±‡∏ô!"
    };

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏î‡πâ‡∏≤‡∏ô (‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏∏‡πà‡∏°)
    private string[][] partSpecificMessages = new string[][]
    {
        // Upper Body
        new string[]
        {
            "‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡πà‡∏≠‡∏ô‡∏ö‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏°‡∏∑‡∏≠‡∏õ‡∏£‡∏≤‡∏ö‡∏¢‡∏∏‡∏á‡∏•‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤‡∏ï‡πà‡∏≠‡∏î‡∏π‡πÑ‡∏´‡∏°! ‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏Ç‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏´‡∏•‡πà‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô!",
            "‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ó‡πà‡∏≠‡∏ô‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤‡∏î‡∏π‡∏™‡∏¥ ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ù‡∏∂‡∏Å‡πÅ‡∏Ç‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏´‡∏•‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô!"
        },
        // Lower Body
        new string[]
        {
            "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏¢‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã‡∏î‡∏π‡∏™‡∏¥! ‡∏Ç‡∏≤‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏à‡∏∞‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô",
            "‡∏™‡πà‡∏ß‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã‡∏î‡∏π‡πÑ‡∏´‡∏°? ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ç‡∏≤‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏•‡∏¢!"
        },
        // Agility
        new string[]
        {
            "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏Ñ‡∏•‡πà‡∏ß‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ô‡∏∞ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏°‡∏∑‡∏≠‡∏õ‡∏£‡∏≤‡∏ö‡∏¢‡∏∏‡∏á‡∏•‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡πà‡∏≠‡πÑ‡∏õ! ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏Ñ‡∏•‡πà‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô",
            "‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏Ñ‡∏•‡πà‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏°‡∏∑‡∏≠‡∏õ‡∏£‡∏≤‡∏ö‡∏¢‡∏∏‡∏á‡∏•‡∏≤‡∏¢‡∏î‡∏π‡∏™‡∏¥ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô!"
        },
        // Flexibility
        new string[]
        {
            "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏ô‡∏∞ ‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ! ‡πÄ‡∏Å‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô",
            "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏µ‡∏Å‡πÄ‡∏¢‡∏≠‡∏∞‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤‡∏î‡∏π‡∏™‡∏¥ ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏¢‡∏∑‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î‡∏ï‡∏±‡∏ß‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô!"
        },
        // Hand-Eye
        new string[]
        {
            "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏°‡∏∑‡∏≠‡∏Å‡∏±‡∏ö‡∏™‡∏≤‡∏¢‡∏ï‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ‡∏≠‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡∏ô‡∏∏‡∏Å‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏≤‡∏î‡∏π‡∏™‡∏¥! ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏°‡∏∑‡∏≠‡∏Å‡∏±‡∏ö‡∏ï‡∏≤‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô",
            "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏°‡∏∑‡∏≠‡∏Å‡∏±‡∏ö‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏î‡∏µ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏≤‡∏î‡∏π‡πÑ‡∏´‡∏°? ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏ù‡∏∂‡∏Å‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏•‡∏¢!"
        }
    };

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô
    private string[] multipleWeaknessMessages = new string[]
    {
        "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏î‡πâ‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏Å‡πá ‡∏°‡∏∑‡∏≠‡∏õ‡∏£‡∏≤‡∏ö‡∏¢‡∏∏‡∏á‡∏•‡∏≤‡∏¢‡∏î‡∏π‡∏™‡∏¥! ‡πÄ‡∏Å‡∏°‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏î‡πâ‡∏≤‡∏ô‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô",
        "‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏≠‡∏µ‡∏Å‡∏ô‡∏∞ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡πâ‡∏≤‡∏™‡∏°‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏•‡∏≠‡∏á‡∏Ñ‡∏ß‡∏¥‡∏ã ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡∏´‡∏£‡∏£‡∏©‡∏≤‡∏î‡∏π‡πÑ‡∏´‡∏°?"
    };

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô
    private string[] balancedMessages = new string[]
    {
        "‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡πÄ‡∏•‡∏¢! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏±‡∏ô‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏ô‡πâ‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡πÄ‡∏•‡∏¢!",
        "‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÜ‡∏Å‡∏±‡∏ô ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏ô‡∏∏‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô‡∏î‡∏π‡∏™‡∏¥!",
        "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≠‡∏á‡∏î‡∏µ‡∏ó‡∏∏‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏¢ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞!"
    };

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏¥‡∏î‡∏ó‡πâ‡∏≤‡∏¢
    private string[] closingMessages = new string[]
    {
        "‡∏°‡∏≤‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡∏™‡∏ô‡∏∏‡∏Å‡πÅ‡∏•‡∏∞‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏°‡∏±‡πâ‡∏¢?",
        "‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡πÜ‡∏ô‡∏∞! ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà!",
        "‡πÑ‡∏õ‡πÄ‡∏•‡πà‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢! ‡∏ô‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô!",
        "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏°‡∏±‡πâ‡∏¢? ‡∏°‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞!"
    };

    void Start()
    {
        point = new int[5];
        StartCoroutine(WaitAndUpdateAdvice());
    }

    IEnumerator WaitAndUpdateAdvice()
    {
        yield return new WaitForSeconds(2f);
        UpdatePointsAndAdvice();
    }

    public void UpdatePointsAndAdvice()
    {
        if (dashboardController == null)
        {
            Debug.LogError("‚ùå DashboardController reference is missing!");
            StartCoroutine(TypeText("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"));
            return;
        }

        for (int i = 0; i < 5; i++)
        {
            point[i] = dashboardController.part[i];
        }

        Debug.Log($"üìä Points loaded: [{string.Join(", ", point)}]");
        GenerateAdvice();
    }

    void GenerateAdvice()
    {
        int minScore = point.Min();
        
        var lowestIndices = point
            .Select((score, index) => new { score, index })
            .Where(x => x.score == minScore)
            .Select(x => x.index)
            .ToList();

        string fullMessage = GenerateAdviceText(lowestIndices, minScore);
        
        // ‡πÄ‡∏£‡∏¥‡πà‡∏° Typewriter Effect
        StartCoroutine(TypeText(fullMessage));
        
        Debug.Log($"üí¨ Advice generated: {fullMessage}");
    }

    // üé¨ Typewriter Effect Animation
    IEnumerator TypeText(string textToType)
    {
        if (isTyping)
        {
            StopAllCoroutines();
        }
        
        isTyping = true;
        dialogueadvisor.text = "";
        
        foreach (char letter in textToType.ToCharArray())
        {
            dialogueadvisor.text += letter;
            yield return new WaitForSeconds(typingSpeed);
        }
        
        isTyping = false;
    }

    string GenerateAdviceText(System.Collections.Generic.List<int> lowestIndices, int minScore)
    {
        if (lowestIndices.Count == 0)
        {
            return "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
        }

        string opening = openingMessages[Random.Range(0, openingMessages.Length)];
        string closing = closingMessages[Random.Range(0, closingMessages.Length)];
        string mainContent = "";

        // ‡∏Å‡∏£‡∏ì‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô
        if (lowestIndices.Count == 5)
        {
            mainContent = balancedMessages[Random.Range(0, balancedMessages.Length)];
            return $"{opening}\n\n{mainContent}\n\n{closing}";
        }

        // ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô
        if (lowestIndices.Count > 1)
        {
            mainContent = multipleWeaknessMessages[Random.Range(0, multipleWeaknessMessages.Length)];
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á
            string weakParts = "";
            for (int i = 0; i < lowestIndices.Count; i++)
            {
                weakParts += partNames[lowestIndices[i]];
                if (i < lowestIndices.Count - 1)
                {
                    weakParts += ", ";
                }
            }
            
            return $"{opening}\n\n‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô {minScore} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‡πÉ‡∏ô: {weakParts}\n\n{mainContent}\n\n{closing}";
        }

        // ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î
        int weakestPart = lowestIndices[0];
        string[] possibleMessages = partSpecificMessages[weakestPart];
        mainContent = possibleMessages[Random.Range(0, possibleMessages.Length)];

        return $"{opening}\n\n{mainContent}\n\n{closing}";
    }

    public void OnDateChanged()
    {
        StartCoroutine(WaitAndUpdateAdvice());
    }

    public void ForceUpdateAdvice()
    {
        UpdatePointsAndAdvice();
    }
}